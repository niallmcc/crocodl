<html>
<head>
    <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/normalize.css">
    <link rel="stylesheet" href="/css/skeleton.css">
    <link rel="stylesheet" href="/css/custom.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script type="text/javascript" src="/js/runtime.js"></script>
    <script type="text/javascript" src="/js/train_runtime.js"></script>
    <script type="text/javascript" src="/js/score_runtime.js"></script>
</head>

<body onload="boot_train_runtime();boot_score_runtime(true);">
<div class="container">
    <h1>Train an Image Anomaly Model</h1>
    <fieldset>
        <legend>Data Settings</legend>
        <div class="row">
            <div class="one-half column">
                <label for="upload_training_data_file">Choose Training Examples Zip to Upload</label>
            </div>
            <div class="one-half column">
                <input type="file" id="upload_training_data_file"/>
                <progress id="upload_training_data_progress" min="0" max="100" value="0" style="display:none;">0% complete
                </progress>
            </div>
        </div>
        <div class="row">
            <div class="one-half column">
                <label for="upload_testing_data_file">Choose Testing Examples Zip to Upload</label>
            </div>
            <div class="one-half column">
                <input type="file" id="upload_testing_data_file"/>
                <progress id="upload_testing_data_progress" min="0" max="100" value="0" style="display:none;">0% complete
                </progress>
            </div>
        </div>
        <div class="row">
            <div class="one-half column">
                <label for="upload_other_data_file">Choose Other Images Zip to Upload (for Model Evaluation)</label>
            </div>
            <div class="one-half column">
                <input type="file" id="upload_other_data_file"/>
                <progress id="upload_other_data_progress" min="0" max="100" value="0" style="display:none;">0% complete
                </progress>
            </div>
        </div>
        <div class="row">
            <div id="data_info">No data loaded</div>
        </div>
    </fieldset>
    <fieldset>
        <legend>Model Settings</legend>
         <div class="row">
            <div class="one-half column">
                <label for="create_model">
                <input type="radio" id="create_model" name="model" value="create_model" checked/>
                    Create New Model
                </label>
            </div>
            <div class="one-half column">
                <select id="architectures">
                </select>
            </div>
        </div>
        <div class="row">
            <div class="one-half column">
                <label for="upload_model">
                    <input type="radio" id="upload_model" name="model" value="upload_model"/>
                    Upload Existing Model
                </label>
            </div>
            <div class="one-half column">
                <label for="upload_model_file">Choose File</label>
                <input type="file" id="upload_model_file"/>
                <progress id="upload_model_progress" min="0" max="100" value="0" style="display:none;">0% complete
                </progress>
            </div>
        </div>
        <div class="row">
            <div id="model_info">No model defined</div>
        </div>
         <div class="row">
            <div class="one-half column">
                Download Link:
            </div>
            <div class="one-half column">
                <a id="model_download">(No model to download)</a>
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>Training Settings</legend>
        <div class="row">
            <div class="one-half column">
                <label for="nr_epochs">
                    Number of Epochs
                    <input type="number" id="nr_epochs" min="1" value="5" />
                </label>
            </div>
            <div class="one-half column">
                <label for="batch_size">
                    Batch Size
                    <input type="number" id="batch_size" min="1" value="16" />
                </label>
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>Training Progress</legend>
        <div class="row">
            <div class="one-half column">
                <label for="train_button">
                    <input class="button-primary" type="button" id="train_button" value="Start training" />
                    <span id="training_status"></span>
                </label>
                <a href="view_code" target="_blank">View Code</a>
            </div>
            <div class="one-half column">
                <label for="training_progress">Training Progress
                    <progress id="training_progress" min="0" max="100" value="0">0% complete
                    </progress>
                </label>
            </div>
        </div>
        <div class="row">
            <select id="chart_types">
            </select>
        </div>
        <div class="row">
            <div class="column">
                <canvas id="metrics_chart"></canvas>
            </div>
        </div>
        <div class="row" id="training_report">
            <div class="column">
                <a href="training_report.html" target="_blank">Training Report</a>
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>Get Anomaly Score for Image</legend>
        <div class="row">
            <div class="one-half column">
                <label for="upload_image_file">Choose Image File</label>
                <input type="file" id="upload_image_file"/>
                <div>
                    <img width="256" id="image"/>
                </div>
                <a href="view_score_code" target="_blank">View Code</a>
            </div>
            <div class="one-half column">
                <progress id="upload_image_progress" min="0" max="100" value="0" style="display:none;">0% complete
                </progress>
                <div id="score_status"></div>
                <table id="score_table" style="display:none;">
                    <thead>
                        <tr>
                            <th>Class</th>
                            <th>Score</th>
                        </tr>
                    </thead>
                    <tbody id="score_table_body">
                    </tbody>
                </table>
                <table id="distance_table" style="display:none;">
                    <thead>
                        <tr>
                            <th>Distance</th>
                        </tr>
                    </thead>
                    <tbody id="distance_table_body">
                    </tbody>
                </table>
            </div>
        </div>
    </fieldset>
</div>
</body>
</html>